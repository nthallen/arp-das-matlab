%%
% HWV T30K extrapolation
D = [
     240 149.77374
   304 139.94016
   360 133.22126
   424 126.81630
   480 122.07367
   544 117.37692
   656 110.44108
   776 104.44295
   896 99.40565
  1016 95.03216
  1184 89.86683
  1368 85.05750
  1600 79.94779
  1888 74.65638
  2184 70.01943
  2480 66.11000
  2592 64.69045
  3000 60.16219
  3528 55.19444
  4176 50.04177
  4928 45.00872
  5808 39.98948
  6800 35.13474
  7040 34.10256
  7976 30.14900
  8096 29.68644
  9376 24.95493
  10904 19.93996
  12536 15.09820
  14288 10.28893
  14528 9.65120
  16160 5.42143
  16632 4.22154
  20376 -5.19987
  22248 -10.07644
  24008 -14.94382
  25640 -19.91098
  27048 -24.77442
  27160 -25.18974
  28328 -29.91959
  29384 -35.05450
  30200 -39.95834
];
Vref = 65536;
Rpu = 75e3;
V = D(:,1);
T = D(:,2);
Rth = Rpu * (V./(Vref - V));
%%
a = SteinHart_fit(Rth,T+273.15);
Counts = 1:64000;
Rthextrap = Rpu*(Counts./(Vref - Counts));
Textrap = SteinHart(Rthextrap, a);
%%
figure;
ax = [ nsubplot(2,1,1) nsubplot(2,1,2) ];
plot(ax(1),Rth,T,Rthextrap,Textrap);

Tsh = SteinHart(Rth,a);
plot(ax(2),Rth,T-Tsh);
set(ax(1),'XTickLabel',[]);
set(ax(2),'YAxisLocation','Right');
linkaxes(ax,'x');
